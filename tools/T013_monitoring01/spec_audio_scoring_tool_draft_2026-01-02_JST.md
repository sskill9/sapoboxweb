# 音声スコアリングツール 仕様ドラフト（途中経過）
更新日: 2026-01-02（JST）

---

## 1. ツール概要

### ツール名称
- 音声スコアリングツール

### 目的
- シンプルかつ流動的な現場に合わせた評価システムの提供
- 評価項目の「対象/非対象」や「評価対象なし（N/A）」を運用で柔軟に切り替え可能にする
- Genesys / Amazon Connect / BIZTEL 等の録音/コンタクトデータ差を吸収できるようにする

### 絶対条件
- オフライン動作（ローカル完結）

---

## 2. 想定データ
- Excel（評価対象一覧・結果保存）
- JavaScript（評価項目マスタ・評価シート定義）
- 音声ファイル（MP3 / WAV）
- （任意）Transcript（テキスト）

---

## 3. 評価方式（スコア計算仕様）

### 3.1 回答値（3値）
- YES
- NO
- 評価対象なし（N/A）

### 3.2 項目の「スコア対象」制御
- スコア対象（対象/非対象）の情報は **評価シート側（hyoukasheet01.js）** に持たせる
- 理由:
  - 前回は対象だった項目が次回は非対象になる、または逆もあり得るため
  - 「対象/非対象」は項目の固定属性ではなく、評価開始時の運用判断とする

### 3.3 母数（最大母数）定義
母数に入るのは以下の両方を満たす項目のみ:
1. スコア対象 = 対象
2. 回答が YES または NO
- 「評価対象なし（N/A）」は母数から除外
- 「スコア対象 = 非対象」は常に母数から除外

### 3.4 達成数（YES数）
- スコア対象 = 対象 かつ 回答 = YES の件数

### 3.5 達成率（スコア）
- 達成率 = YES数 / 母数
- 母数 = 0 の場合:
  - 仕様として「未評価（—）」扱い
  - ただし運用上、項目数 15〜30想定のため通常は発生しない（抽出条件で除外される想定）

---

## 4. Excel設計（列名はすべて日本語）

### 4.1 位置づけ
- 1行 = 1評価対象（基本: 1通話/1音声ファイル）
- Excelは「評価対象一覧」と「評価結果保存」を兼ねる想定

### 4.2 紐づけキー（確定）
- コンタクトID列を保持（通話単位の識別）
- 音声ID列を保持（音声ファイルとの一致キー）
- 音声IDは **ファイル名そのもの（拡張子込み）** を採用（確定）
  - 例: abc123.wav / xyz999.mp3

### 4.3 ユーザー提示の必須列（ドラフト）
- NO
- 対象者名
- 対象者所属チーム
- 評価者
- 対応日
- 評価日
- 評価期間（例：2026_1Q、2026年2月等）
- 利用シート
- IN/OUT
- コンタクトID
- 音声ID
- 顧客タイプ（個人or法人orその他）
- 通話時間
- 音声抽出条件（達成・未達）
- 評価項目数（全数）
- 内スコア対象項目数（評価項目数）
- YES数（評価項目数の内）
- NO数（評価項目数の内）
- 評価対象なし数（評価項目数の内）
- 達成率
- 評価者コメント
- 次回改善目標
- トランスクリプト
- 評価01(NO)
- 評価01(結果)
- …評価50まで繰り返し
- 評価50(NO)
- 評価50(結果)

#### 補足（運用上の前提）
- 「評価01〜50」は列固定
- 「評価XX(NO)」には **ユニークID** を入れる（確定）

---

## 5. 評価項目・評価シートのファイル設計（JS）

### 5.1 hyoukakoumoku01.js（評価項目マスタ）
役割:
- 評価項目の候補（辞書）を保持
- 「変わりにくい定義情報」を管理

各項目が持つ情報（確定）:
- ユニークID（日本語＋_＋3桁）
  - 例: オープニング_001 / ヒアリング_001 / ホスピタリティ_001 / クロージング_001
- 評価タイプ（例: オープニング / ヒアリング 等）
- 評価名
- 評価目的（あるべき姿）
- 判定基準

備考:
- 評価タイプはユニークIDのカテゴリ名と重なる想定（問題なし）
  - 役割: ユニークID＝識別、評価タイプ＝分類/集計軸

### 5.2 hyoukasheet01.js（評価シート履歴ストア）
役割:
- 実運用で使う評価シート（評価項目の採用セット）を保持
- 過去の評価シートも **同一ファイル内に追記して履歴として保持**
- どのシートを現在使うかは activeSheetId で切替

#### 履歴の持ち方（確定）
- 1ファイル内に sheets 配列を持ち、**シート単位**で追加していく（過去分は消去しない）
- 運用中のシートは activeSheetId が指す

#### 1シートが持つべき情報（確定）
- 評価シートID / 評価シート名 / 評価期間 / 作成日 / 作成者 / メモ（などのメタ情報）
- slots（評価01〜評価50に対応）
  - スロットNO（1〜50）
  - 評価ID（ユニークID）
  - スコア対象（対象/非対象）  ※この情報はシート側に持つ（確定）

---

## 6. 運用イメージ（例）

### 6.1 2026年1月の評価実施
- hyoukasheet01.js の sheets に「2026年1月用シート」を1件登録
- activeSheetId を 2026年1月シートに設定
- 評価実施時:
  - slots に従い、評価01〜50にユニークIDを割り当て
  - 結果（YES/NO/N/A）を入力し、Excelへ保存

### 6.2 2026年2月の評価実施
- hyoukasheet01.js の sheets に「2026年2月用シート」を追記（過去分は消さない）
- activeSheetId を 2026年2月シートへ切替
- 以降の評価は2月シートの slots と スコア対象 を基準に実施

---

## 7. 未決事項（次回詰める）
- Excel列の確定（入力列/出力列の仕分け、列順、型、必須/任意の分類）
- 「利用シート」列と hyoukasheet01.js の「評価シートID」の関係整理（同一概念に寄せるか）
- 「音声抽出条件（達成・未達）」の定義（抽出ロジック、判定タイミング）
- Transcriptの入力方法（Excel貼り付け、別ファイル、音声から自動生成は対象外など）
- UI/画面構成（評価画面、一覧、フィルタ、音声プレイヤー、検索）
- MP3/WAVの読み込み方式（ドラッグ&ドロップ/フォルダ選択 等）
- コンタクトID・音声IDのベンダー別値の取り扱い（Genesys/Connect/Biztelの想定フィールド）

---

## 8. 次回の開始点（ToDo）
1. Excel列を「入力（評価前）」と「出力（評価後）」に分類
2. 列順を決める（運用で入力しやすい順）
3. 「評価01〜50」列の確定仕様（評価XX(NO)＝ユニークID、評価XX(結果)＝3値）
4. hyoukasheet01.js の「評価シートID」とExcelの保存列の紐付け方針を確定

---
